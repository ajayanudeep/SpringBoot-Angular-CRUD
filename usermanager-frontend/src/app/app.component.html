<head>
  <title>{{title}}</title>
</head>
<body>
  <nav>
    <h4 style="margin-top: 5px; font-size: 20px;">User Manager</h4>
    <div>
      <button type="button" data-bs-toggle="modal" data-bs-target="#addModal">Add User</button>
      <form action="">
        <input name="key" (ngModelChange)="search(key.value)" #key="ngModel" ngModel type="search" id="" placeholder="Search User">
      </form>
    </div>
  </nav>
  <div id="main" class="user-list" >
    <div class="user" *ngFor="let user of users">
      <div class="user-header">
        <img src={{user.imageUrl}} alt="" />
        <div style="display: flex; justify-content: space-between;width: 50px;align-items: center;">
          <button (click)="set_updateUser($event,user)" type="button" data-bs-toggle="modal" data-bs-target="#updateModal" style="cursor:pointer;border:none;border-radius:40px;width:20px;background: none;"><i style="color: blue;font-size: 20px;" class="fa fa-pencil-square-o" aria-hidden="true"></i></button>          
          <button (click)="set_deleteUser($event,user)" type="button" data-bs-toggle="modal" data-bs-target="#deleteModal" style="cursor: pointer;border:none;border-radius:40px;width:20px;background: none;"><i style="color: red;font-size: 20px;" class="fa fa-trash" aria-hidden="true"></i></button>
        </div>
      </div>
      <p style="margin-top: 10px;">{{user.name}}</p>
      <p>{{user.email}}</p>
      <p>{{user.jobTitle}}</p>
      <p>{{user.phone}}</p>
    
      <!-- Add Modal -->
      <div class="modal fade" id="addModal" tabindex="-1" aria-labelledby="addModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="exampleModalLabel">Add User</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form #addForm="ngForm" (ngSubmit)="addUser(addForm)">
                <div class="mb-3">
                  <input placeholder="Enter Name" ngModel name="name" type="text" class="form-control" id="recipient-name">
                </div>
                <div class="mb-3">
                  <input placeholder="Enter Email" ngModel name="email" type="text" class="form-control" id="recipient-name">
                </div>
                <div class="mb-3">
                  <input placeholder="Enter Job Title" ngModel name="jobTitle" type="text" class="form-control" id="recipient-name">
                </div>
                <div class="mb-3">
                  <input placeholder="Enter Phone" ngModel name="phone" type="text" class="form-control" id="recipient-name">
                </div>
                <div class="mb-3">
                  <input placeholder="Enter Image URL" ngModel name="imageUrl" type="text" class="form-control" id="recipient-name">
                </div>
                <div class="modal-footer">
                  <button id="add-negative"  type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                  <button [disabled]="addForm.invalid" id="positive" type="submit" class="btn btn-primary">Add User</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
      <!-- Update Modal -->
      <div class="modal fade" id="updateModal" tabindex="-1" aria-labelledby="updateModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="exampleModalLabel">Edit User</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form #updateForm="ngForm">
                <div class="mb-3">
                  <input placeholder="Enter Name" ngModel="{{editUser?.name}}" name="name" type="text" class="form-control" id="recipient-name">
                </div>
                <input type="hidden" ngModel="{{editUser?.id}}" name="id" id="">
                <input type="hidden" ngModel="{{editUser?.userCode}}" name="userCode" id="">
                <div class="mb-3">
                  <input placeholder="Enter Email" ngModel="{{editUser?.email}}" name="email" type="text" class="form-control" id="recipient-name">
                </div>
                <div class="mb-3">
                  <input placeholder="Enter JobTitle" ngModel="{{editUser?.jobTitle}}" name="jobTitle" type="text" class="form-control" id="recipient-name">
                </div>
                <div class="mb-3">
                  <input placeholder="Enter Phone" ngModel="{{editUser?.phone}}" name="phone" type="text" class="form-control" id="recipient-name">
                </div>
                <div class="mb-3">
                  <input placeholder="Enter Image URL" ngModel="{{editUser?.imageUrl}}" name="imageUrl" type="text" class="form-control" id="recipient-name">
                </div>
                <div class="modal-footer">
                  <button id="update-negative" type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                  <button (click)="updateUser(updateForm.value)" id="positive" type="submit" class="btn btn-primary">Save Changes</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
      <!--Delete Modal -->
      <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="exampleModalLabel">Delete User</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              Are you sure you want to delete the user {{deletedUser?.name}} ?
            </div>
            <div class="modal-footer">
              <button id="delete-positive" type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
              <button (click)="delete_User(deletedUser.id)" id="negative" type="button" class="btn btn-secondary">Yes</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div> 
</body>
